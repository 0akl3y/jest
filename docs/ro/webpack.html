<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Using with webpack · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Using with webpack · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/jest/index.html"/><meta property="og:description" content="Jest poate fi utilizat în proiecte care folosesc [webpack](https://webpack.github.io/) pentru gestionarea fișierelor statice, stiluri şi compilare. webpack *oferă* nişte provocări unice față de alte instrumente deoarece se integrează direct cu aplicația voastră pentru a permite gestionarea stilurilor, resurselor statice cum ar fi imagini şi fonturi, împreună cu ecosistemul expansiv de compilare în JavaScript a limbajelor şi instrumentelor."/><meta property="og:image" content="/jest/img/opengraph.png"/><link rel="shortcut icon" href="/jest/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="/jest/css/main.css"/><link rel="alternate" type="application/atom+xml" href="https://facebook.github.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://facebook.github.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/jest/"><img class="logo" src="/jest/img/jest.svg"/><h2 class="headerTitle">Jest</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/ro/getting-started.html" target="_self">Documentație</a></li><li><a href="/jest/docs/ro/api.html" target="_self">API</a></li><li><a href="/jest/ro/help.html" target="_self">Ajutor</a></li><li><a href="/jest/blog" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/jest/img/language.svg"/>Română</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/jest/en">English</a></li><li><a href="/jest/ja">日本語</a></li><li><a href="/jest/es-ES">Español</a></li><li><a href="/jest/pt-BR">Português (Brasil)</a></li><li><a href="/jest/ru">Русский</a></li><li><a href="/jest/uk">Українська</a></li><li><a href="/jest/zh-Hans">简体中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Guides</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/ro/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/using-matchers.html">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/asynchronous.html">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/setup-teardown.html">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/mock-functions.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/more-resources.html">More Resources</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/ro/api.html">Globals</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/expect.html">Expect</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/mock-function-api.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/jest-object.html">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/configuration.html">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/cli.html">Jest CLI Options</a></li></ul></div><div class="navGroup navGroupActive"><h3>Framework Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/ro/tutorial-react.html">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/tutorial-react-native.html">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/testing-frameworks.html">Testing Web Frameworks</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/ro/snapshot-testing.html">Testarea de imagine</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/tutorial-async.html">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/timer-mocks.html">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/manual-mocks.html">Manual Mocks</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/jest/docs/ro/webpack.html">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/migration-guide.html">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/ro/troubleshooting.html">Troubleshooting</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Using with webpack</h1></header><article><div><span><p>Jest poate fi utilizat în proiecte care folosesc <a href="https://webpack.github.io/">webpack</a> pentru gestionarea fișierelor statice, stiluri şi compilare. webpack <em>oferă</em> nişte provocări unice față de alte instrumente deoarece se integrează direct cu aplicația voastră pentru a permite gestionarea stilurilor, resurselor statice cum ar fi imagini şi fonturi, împreună cu ecosistemul expansiv de compilare în JavaScript a limbajelor şi instrumentelor.</p>
<h2><a class="anchor" name="un-exemplu-webpack"></a>Un exemplu webpack <a class="hash-link" href="#un-exemplu-webpack">#</a></h2>
<p>Să începem cu un fişier de configurare webpack comun pe care să-l traducem într-o configurare Jest.</p>
<pre><code class="language-js"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">loaders</span>: [
      {<span class="hljs-attr">exclude</span>: [<span class="hljs-string">'node_modules'</span>], <span class="hljs-attr">loader</span>: <span class="hljs-string">'babel'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jsx?$/</span>},
      {<span class="hljs-attr">loader</span>: <span class="hljs-string">'style-loader!css-loader'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>},
      {<span class="hljs-attr">loader</span>: <span class="hljs-string">'url-loader'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.gif$/</span>},
      {<span class="hljs-attr">loader</span>: <span class="hljs-string">'file-loader'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|eot|svg)$/</span>},
    ],
  },
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-attr">config$</span>: <span class="hljs-string">'./configs/app-config.js'</span>,
      <span class="hljs-attr">react</span>: <span class="hljs-string">'./vendor/react-master'</span>,
    },
    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">''</span>, <span class="hljs-string">'js'</span>, <span class="hljs-string">'jsx'</span>],
    <span class="hljs-attr">modules</span>: [
      <span class="hljs-string">'node_modules'</span>, 
      <span class="hljs-string">'bower_components'</span>, 
      <span class="hljs-string">'shared'</span>,
      <span class="hljs-string">'/shared/vendor/modules'</span>,
    ],
  },
};
</code></pre>
<p>If you have JavaScript files that are transformed by Babel, you can <a href="/jest/docs/ro/getting-started.html#using-babel-with-jest">enable support for Babel</a> by installing the <code>babel-jest</code> plugin. Non-Babel JavaScript transformations can be handled with Jest's <a href="/jest/docs/ro/configuration.html#transform-object-string-string"><code>transform</code></a> config option.</p>
<h3><a class="anchor" name="gestionarea-resurselor-statice"></a>Gestionarea resurselor statice <a class="hash-link" href="#gestionarea-resurselor-statice">#</a></h3>
<p>În continuare, să configurăm Jest să se ocupe de fișierele statice, cum ar fi stilurile şi imaginile. De obicei, aceste fişiere nu sunt deosebit de utile în teste, astfel încât putem liniștiți să le dublăm. Cu toate acestea, dacă utilizaţi module CSS atunci este preferat să dublați un proxy pentru căutările className.</p>
<pre><code class="language-json">// package.json
{
  "jest": {
    "moduleNameMapper": {
      "\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$": "&lt;rootDir&gt;/__mocks__/fileMock.js",
      "\\.(css|less)$": "&lt;rootDir&gt;/__mocks__/styleMock.js"
    }
  }
}
</code></pre>
<p>Şi fișierele dubluri:</p>
<pre><code class="language-js"><span class="hljs-comment">// __mocks__/styleMock.js</span>

<span class="hljs-built_in">module</span>.exports = {};
</code></pre>
<pre><code class="language-js"><span class="hljs-comment">// __mocks__/fileMock.js</span>

<span class="hljs-built_in">module</span>.exports = <span class="hljs-string">'test-file-stub'</span>;
</code></pre>
<h3><a class="anchor" name="dublarea-modulelor-css"></a>Dublarea modulelor CSS <a class="hash-link" href="#dublarea-modulelor-css">#</a></h3>
<p>Puteți utiliza un <a href="https://github.com/keyanzhang/identity-obj-proxy">ES6 Proxy</a> pentru a mock-ui <a href="https://github.com/css-modules/css-modules">module CSS</a>:</p>
<pre><code>npm install --save-dev identity-obj-proxy
</code></pre>
<p>Apoi toate căutările pentru className pe obiectul de stiluri va fi returnat ca-atare (de exemplu, <code>styles.foobar === 'foobar'</code>). This is pretty handy for React <a href="/jest/docs/ro/snapshot-testing.html">Snapshot Testing</a>.</p>
<pre><code class="language-json">// package.json (for CSS Modules)
{
  "jest": {
    "moduleNameMapper": {
      "\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$": "&lt;rootDir&gt;/__mocks__/fileMock.js",
      "\\.(css|less)$": "identity-obj-proxy"
    }
  }
}
</code></pre>
<blockquote>
<p>A se ține cont că Proxy este activat implicit în Node 6. Dacă nu folosiți Node 6 încă, asiguraţi-vă că invocați Jest folosind <code>node --harmony_proxies node_modules/.bin/jest</code>.</p>
</blockquote>
<p>If <code>moduleNameMapper</code> cannot fulfill your requirements, you can use Jest's <a href="/jest/docs/ro/configuration.html#transform-object-string-string"><code>transform</code></a> config option to specify how assets are transformed. De exemplu, un transformator care returnează numele de bază al unui fişier (astfel încât <code>require('logo.jpg');</code> returnează <code>'logo'</code>) poate fi scris astfel:</p>
<pre><code class="language-js"><span class="hljs-comment">// fileTransformer.js</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-built_in">module</span>.exports = {
  process(src, filename, config, options) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'module.exports = '</span> + <span class="hljs-built_in">JSON</span>.stringify(path.basename(filename)) + <span class="hljs-string">';'</span>;
  },
};
</code></pre>
<pre><code class="language-json">// package.json (for custom transformers and CSS Modules)
{
  "jest": {
    "moduleNameMapper": {
      "\\.(css|less)$": "identity-obj-proxy"
    },
    "transform": {
      "\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$": "&lt;rootDir&gt;/fileTransformer.js"
    }
  }
}
</code></pre>
<p>I-am specificat lui Jest să ignore fişiere de stil sau imagini, şi în schimb, să includă fișierele noastre mock. Puteţi ajusta expresia regulată pentru a se potrivi tipurilor de fișiere pe care configuratia voastră webpack o gestionează.</p>
<p><em>Notă: dacă utilizaţi babel-jest cu preprocesoare de cod adiționale, trebuie să definească explicit babel-jest ca un transformator pentru codul JavaScript pentru a mapa fişierele <code>.js</code> către modulul babel-jest.</em></p>
<pre><code class="language-json">"transform": {
  "^.+\\.js$": "babel-jest",
  "^.+\\.css$": "custom-transformer",
  ...
}
</code></pre>
<h3><a class="anchor" name="configurarea-jest-pentru-a-g-si-fi-ierele-noastre"></a>Configurarea Jest pentru a găsi fişierele noastre <a class="hash-link" href="#configurarea-jest-pentru-a-g-si-fi-ierele-noastre">#</a></h3>
<p>Acum că Jest ştie cum să prelucreze fişierele noastre, avem nevoie să îi spunem cum să le <em>găsească</em>. Pentru opțiunile webpack <code>modulesDirectories</code>, şi <code>extensions</code> exista opțiuni analoage în Jest respectiv <code>moduleDirectories</code> şi <code>moduleFileExtensions</code>.</p>
<pre><code class="language-json">// package.json
{
  "jest": {
    "moduleFileExtensions": ["js", "jsx"],
    "moduleDirectories": ["node_modules", "bower_components", "shared"],

    "moduleNameMapper": {
      "\\.(css|less)$": "&lt;rootDir&gt;/__mocks__/styleMock.js",    
      "\\.(gif|ttf|eot|svg)$": "&lt;rootDir&gt;/__mocks__/fileMock.js"
    }
  }
}
</code></pre>
<blockquote>
<p>Notă: &lt;rootdir&gt; este un simbol special, care este înlocuit de Jest cu rădăcina proiectului vostru. Cele mai multe ori acesta va fi directorul în care package.json se află dacă nu specificaţi o altă opţiune <code>rootDir</code> în configuraţie.</p>
</blockquote>
<p>În mod similar opțiunea webpack <code>resolve.root</code> funcţionează la fel ca setarea variabilei <code>NODE_PATH</code> sau se poate folosi opţiunea <code>modulePaths</code>.</p>
<pre><code class="language-json">// package.json
{
  "jest": {
    "modulePaths": [
      "/shared/vendor/modules"
    ],
    "moduleFileExtensions": ["js", "jsx"],
    "moduleDirectories": ["node_modules", "bower_components", "shared"],
    "moduleNameMapper": {
      "\\.(css|less)$": "&lt;rootDir&gt;/__mocks__/styleMock.js",    
      "\\.(gif|ttf|eot|svg)$": "&lt;rootDir&gt;/__mocks__/fileMock.js"
    }
  }
}
</code></pre>
<p>Şi în cele din urmă avem <code>alias</code>-ul webpack de gestionat. Pentru aceasta putem folosi opțiunea <code>moduleNameMapper</code> din nou.</p>
<pre><code class="language-json">// package.json
{
  "jest": {
    "modulePaths": [
      "/shared/vendor/modules"
    ],
    "moduleFileExtensions": ["js", "jsx"],
    "moduleDirectories": ["node_modules", "bower_components", "shared"],

    "moduleNameMapper": {
      "^react(.*)$": "&lt;rootDir&gt;/vendor/react-master$1",
      "^config$": "&lt;rootDir&gt;/configs/app-config.js",

      "\\.(css|less)$": "&lt;rootDir&gt;/__mocks__/styleMock.js",    
      "\\.(gif|ttf|eot|svg)$": "&lt;rootDir&gt;/__mocks__/fileMock.js"
    }
  }
}
</code></pre>
<p>Asta e tot! webpack este un instrument complex și flexibil, astfel încât va trebui probabil să faceți unele ajustări care să cuprindă nevoile specifice aplicației voastre. Din fericire pentru cele mai multe proiecte, Jest ar trebui să fie mai mult decât suficient de flexibil pentru a gestiona configurarea voastră webpack.</p>
<blockquote>
<p>Notă: Pentru configuraţii webpack mai complexe, ați putea fi interesați să investigați proiecte cum ar fi: <a href="https://github.com/istarkov/babel-plugin-webpack-loaders">babel-plugin-webpack-loaders</a>.</p>
</blockquote>
<h2><a class="anchor" name="folosind-webpack-2"></a>Folosind webpack 2 <a class="hash-link" href="#folosind-webpack-2">#</a></h2>
<p>webpack 2 oferă suport nativ pentru module ES. Cu toate acestea, Jest ruleaza în Node, şi necesită ca modulele ES să fie transpilate în module CommonJS. Astfel, dacă folosiți webpack 2, cel mai probabil veți dori să configuraţi Babel să transpileze modulele ES în module CommonJS numai în mediul de <code>test</code>.</p>
<pre><code class="language-json">// .babelrc
{
  "presets": [
    ["es2015", {"modules": false}]
  ],

  "env": {
    "test": {
      "plugins": ["transform-es2015-modules-commonjs"]
    }
  }
}
</code></pre>
<blockquote>
<p>Notă: Jest cache-uie fişierele pentru a accelera execuția testelor. Dacă aţi actualizat .babelrc şi Jest încă nu funcționează, încercaţi să executaţi Jest cu <code>--no-cache</code>.</p>
</blockquote>
<p>Dacă utilizaţi importuri dinamice (<code>import('some-file.js').then(module =&gt; ...)</code>), trebuie să activaţi plugin-ul <code>dynamic-import-node</code>.</p>
<pre><code class="language-json">// .babelrc
{
  "presets": [
    ["es2015", {"modules": false}]
  ],

  "plugins": ["syntax-dynamic-import"],

  "env": {
    "test": {
      "plugins": ["dynamic-import-node"]
    }
  }
}
</code></pre>
<p>Pentru un exemplu de utilizare Jest cu Webpack, React, Redux şi Node, puteți vedea <a href="https://github.com/jenniferkaplannyc/jest_react_redux_node_webpack_complex_example">aici</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="manual-mocks.html">← Manual Mocks</a><a class="docs-next button" href="migration-guide.html">Migrating to Jest →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/jest/" class="nav-home"><img src="/jest/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/jest/docs/ro/getting-started.html">Getting Started</a><a href="/jest/docs/ro/snapshot-testing.html">Guides</a><a href="/jest/docs/ro/api.html">API Reference</a></div><div><h5>Community</h5><a href="/jest/ro/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discordapp.com/channels/102860784329052160/103622435865104384">Jest Chat</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/jest/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-count-api="/repos/facebook/jest#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/jest/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2017 Facebook Inc.</section></footer></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><script>
              var search = docsearch({
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react'
              });
            </script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>