<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Troubleshooting · Jest</title><meta name="viewport" content="width=device-width"><meta property="og:title" content="Troubleshooting · Jest"><meta property="og:type" content="website"><meta property="og:url" content="https://facebook.github.io/jest/index.html"><meta property="og:image" content="https://facebook.github.io/jest/img/opengraph.png"><meta property="og:description" content="Uh oh, something went wrong? Use this guide to resolve issues with Jest."><link rel="shortcut icon" href="/jest/img/favicon.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"><link rel="stylesheet" href="/jest/css/jest.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="/jest/"><img src="/jest/img/jest_logo_nav.png">Jest</a><div class="nav-site-wrapper"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/tutorial.html#content" class="active">docs</a></li><li><a href="/jest/support.html#content" class="">support</a></li><li><a href="/jest/blog/#content" class="">blog</a></li></ul><div class="algolia-search-wrapper"><input id="algolia-doc-search" type="text" placeholder="Search docs..."></div><ul class="nav-site nav-site-external"><li><a href="https://github.com/facebook/jest" class="">GitHub</a></li></ul></div></div></div><section class="content wrap documentationContent"><div class="nav-docs"><div class="nav-docs-section"><h3>Quick Start</h3><ul><li><a style="margin-left:0;" class="" href="/jest/docs/getting-started.html#content">Getting Started</a></li><li><a style="margin-left:0;" class="" href="/jest/docs/tutorial.html#content">Tutorial</a></li><li><a style="margin-left:0;" class="" href="/jest/docs/tutorial-react.html#content">Tutorial – React</a></li><li><a style="margin-left:0;" class="" href="/jest/docs/tutorial-async.html#content">Tutorial – Async</a></li><li><a style="margin-left:0;" class="" href="/jest/docs/tutorial-jquery.html#content">Tutorial – jQuery</a></li></ul></div><div class="nav-docs-section"><h3>Core Concepts</h3><ul><li><a style="margin-left:0;" class="" href="/jest/docs/common-js-testing.html#content">Module Testing</a></li><li><a style="margin-left:0;" class="" href="/jest/docs/automatic-mocking.html#content">Automatic Mocking</a></li></ul></div><div class="nav-docs-section"><h3>Reference</h3><ul><li><a style="margin-left:0;" class="" href="/jest/docs/api.html#content">API Reference</a></li><li><a style="margin-left:0;" class="active" href="/jest/docs/troubleshooting.html#content">Troubleshooting</a></li><li><a style="margin-left:0;" class="" href="/jest/docs/mock-functions.html#content">Mock functions</a></li><li><a style="margin-left:0;" class="" href="/jest/docs/manual-mocks.html#content">Manual mocks</a></li><li><a style="margin-left:0;" class="" href="/jest/docs/timer-mocks.html#content">Timer mocks</a></li></ul></div></div><div class="inner-content"><a id="content"></a><a class="edit-page-link" href="https://github.com/facebook/jest/blob/master/docs/Troubleshooting.md" target="_blank">Edit on GitHub</a><h1>Troubleshooting</h1><div><p>Uh oh, something went wrong? Use this guide to resolve issues with Jest.</p><h3><a class="anchor" name="an-npm-package-isn-t-properly-being-mocked"></a>An npm package isn&#x27;t properly being mocked. <a class="hash-link" href="#an-npm-package-isn-t-properly-being-mocked">#</a></h3><p>Consider using <code>jest.unmock(&#x27;moduleName&#x27;)</code> or add the path to the node module
to the <a href="/jest/docs/api.html#config-unmockedmodulepathpatterns-array-string" target="">unmockedModulePathPatterns</a>
config option.</p><p>You can also provide a <a href="/jest/docs/manual-mocks.html" target="">manual mock</a> by creating
a <code>moduleName.js</code> file in a <code>__mocks__</code> folder in the root level of your
project.</p><h3><a class="anchor" name="caching-issues"></a>Caching Issues <a class="hash-link" href="#caching-issues">#</a></h3><p>The preprocessor script was changed or babel was updated and the changes aren&#x27;t
being recognized by Jest?</p><p>Retry with <code>--no-cache</code> or <code>rm -rf node_modules/jest-cli/.haste_cache</code>.</p><p>Explanation: Jest caches transformed module files to speed up test execution.
If you are using your own custom preprocessor, consider adding a <code>getCacheKey</code>
function to it: <a href="https://github.com/facebook/relay/blob/master/scripts/jest/preprocessor.js#L63-L67" target="_blank">getCacheKey in Relay</a>.</p><h3><a class="anchor" name="unresolved-promises"></a>Unresolved Promises <a class="hash-link" href="#unresolved-promises">#</a></h3><p>If a promise doesn&#x27;t resolve at all, this error might be thrown:</p><pre class="prism language-javascript">
<span class="token operator">-</span> Error<span class="token punctuation">:</span> Timeout <span class="token operator">-</span> Async callback was not invoked within timeout specified by jasmine<span class="token punctuation">.</span>DEFAULT_TIMEOUT_INTERVAL<span class="token punctuation">.</span>`</pre><p>Most commonly this is being caused by conflicting Promise implementations.
Consider replacing the global promise implementation with your own, for example
<code>global.Promise = require.requireActual(&#x27;promise&#x27;);</code> and/or consolidate the
used Promise libraries to a single one.</p><p>If your test is long running, you may want to consider to increase the timeout
specified in <code>jasmine.DEFAULT_TIMEOUT_INTERVAL</code>.</p><pre class="prism language-javascript">
jasmine<span class="token punctuation">.</span>DEFAULT_TIMEOUT_INTERVAL <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span> <span spellcheck="true" class="token comment">// 10 second timeout</span></pre><h3><a class="anchor" name="watchman-issues"></a>Watchman Issues <a class="hash-link" href="#watchman-issues">#</a></h3><p>Try running Jest with <code>--no-watchman</code> or set the <code>watchman</code> configuration option
to <code>false</code>.</p><p>Also see <a href="https://facebook.github.io/watchman/docs/troubleshooting.html" target="_blank">watchman troubleshooting</a>.</p><h3><a class="anchor" name="i-m-using-npm3-and-my-node-modules-aren-t-properly-loading"></a>I&#x27;m using npm3 and my node_modules aren&#x27;t properly loading. <a class="hash-link" href="#i-m-using-npm3-and-my-node-modules-aren-t-properly-loading">#</a></h3><p>Upgrade <code>jest-cli</code> to <code>0.9.0</code>.</p><h3><a class="anchor" name="i-m-using-babel-and-my-unmocked-imports-aren-t-working"></a>I&#x27;m using babel and my unmocked imports aren&#x27;t working? <a class="hash-link" href="#i-m-using-babel-and-my-unmocked-imports-aren-t-working">#</a></h3><p>Upgrade <code>jest-cli</code> to <code>0.9.0</code>.</p><p>Explanation:</p><pre class="prism language-javascript">
jest<span class="token punctuation">.</span><span class="token function">dontMock</span><span class="token punctuation">(</span><span class="token string">&#x27;foo&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&#x27;./foo&#x27;</span><span class="token punctuation">;</span></pre><p>In ES2015, import statements get hoisted before all other</p><pre class="prism language-javascript">
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;foo&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jest<span class="token punctuation">.</span><span class="token function">dontMock</span><span class="token punctuation">(</span><span class="token string">&#x27;foo&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span spellcheck="true" class="token comment">// Oops!</span></pre><p>In Jest 0.9.0, a new API <code>jest.unmock</code> was introduced. Together with a plugin
for babel, this will now work properly when using <code>babel-jest</code>:</p><pre class="prism language-javascript">
jest<span class="token punctuation">.</span><span class="token function">unmock</span><span class="token punctuation">(</span><span class="token string">&#x27;foo&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span spellcheck="true" class="token comment">// Use unmock!</span>

<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&#x27;./foo&#x27;</span><span class="token punctuation">;</span>

<span spellcheck="true" class="token comment">// foo is not mocked!</span></pre><p>See the <a href="/jest/docs/getting-started.html" target="">Getting Started</a> guide on how to
enable babel support.</p><h3><a class="anchor" name="i-upgraded-to-jest-0-9-0-and-my-tests-are-now-failing"></a>I upgraded to Jest 0.9.0 and my tests are now failing? <a class="hash-link" href="#i-upgraded-to-jest-0-9-0-and-my-tests-are-now-failing">#</a></h3><p>Jest is now using Jasmine 2 by default. It should be easy to upgrade using the
Jasmine <a href="http://jasmine.github.io/2.0/introduction.html" target="_blank">upgrade guide</a>.</p><p>If you would like to continue using Jasmine 1, set the <code>testRunner</code> config
option to <code>jasmine1</code> or pass <code>--testRunner=jasmine1</code> as a command line option.</p><h3><a class="anchor" name="compatibility-issues"></a>Compatibility issues <a class="hash-link" href="#compatibility-issues">#</a></h3><p>Jest takes advantage of new features added to Node 4. We recommend that you
upgrade to the latest stable release of Node. The minimum supported version is
<code>v4.0.0</code>. Versions <code>0.x.x</code> are not supported.</p><h3><a class="anchor" name="still-unresolved"></a>Still unresolved? <a class="hash-link" href="#still-unresolved">#</a></h3><p>See <a href="/jest/support.html" target="">Support</a>.</p></div><div class="docs-prevnext"><a class="docs-next" href="mock-functions.html#content">Next →</a></div></div></section><footer class="wrap"><div class="right">© 2016 Facebook Inc.</div></footer></div><div id="fb-root"></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-387204-10', 'facebook.github.io');
            ga('send', 'pageview');

            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)
            ){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

            docsearch({
              apiKey: '833906d7486e4059359fa58823c4ef56',
              indexName: 'jest',
              inputSelector: '#algolia-doc-search'
            });
          </script></body></html>