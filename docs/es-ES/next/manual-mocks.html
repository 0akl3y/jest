<html lang="es-ES"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Manual Mocks · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Manual Mocks · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/jest/index.html"/><meta property="og:description" content="Las simulaciones mock manuales son usadas para sustituir funcionalidad con datos falsos. Por ejemplo, en lugar de acceder a un recurso apartado como un sitio web o una base de datos, puede que se desee crear una simulación manual que te permita usar datos falsos. Esto asegura que tus pruebas serán más rápidas y corrientes."/><meta property="og:image" content="https://facebook.github.io/jest/img/opengraph.png"/><link rel="shortcut icon" href="/jest/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://facebook.github.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://facebook.github.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/jest/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/jest/"><img class="logo" src="/jest/img/jest.svg"/><h2 class="headerTitle">Jest</h2></a><a href="/jest/es-ES/versions.html"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/es-ES/next/getting-started.html" target="_self">Documentación</a></li><li><a href="/jest/docs/es-ES/next/api.html" target="_self">API</a></li><li><a href="/jest/es-ES/help.html" target="_self">Ayuda</a></li><li><a href="/jest/blog" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/jest/img/language.svg"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/jest/en">English</a></li><li><a href="/jest/ja">日本語</a></li><li><a href="/jest/es-ES">Español</a></li><li><a href="/jest/pt-BR">Português (Brasil)</a></li><li><a href="/jest/ro">Română</a></li><li><a href="/jest/ru">Русский</a></li><li><a href="/jest/uk">Українська</a></li><li><a href="/jest/zh-Hans">简体中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Guides</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/using-matchers.html">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/asynchronous.html">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/setup-teardown.html">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/mock-functions.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/jest-platform.html">Jest Platform</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/jest-community.html">Jest Community</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/more-resources.html">More Resources</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/snapshot-testing.html">Snapshot Testing</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/tutorial-async.html">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/timer-mocks.html">Timer Mocks</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/jest/docs/es-ES/next/manual-mocks.html">Manual Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/es6-class-mocks.html">ES6 Class Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/webpack.html">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/puppeteer.html">
Usar con puppeteer</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/mongodb.html">Utilizando con MongoDB</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/migration-guide.html">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/troubleshooting.html">Troubleshooting</a></li></ul></div><div class="navGroup navGroupActive"><h3>Framework Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/tutorial-react.html">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/tutorial-react-native.html">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/testing-frameworks.html">Testing Web Frameworks</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/api.html">Globals</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/expect.html">Expect</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/mock-function-api.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/jest-object.html">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/configuration.html">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/next/cli.html">Jest CLI Options</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/jest/edit/master/docs/ManualMocks.md" target="_blank">Edit</a><h1>Manual Mocks</h1></header><article><div><span><p>Las simulaciones mock manuales son usadas para sustituir funcionalidad con datos falsos. Por ejemplo, en lugar de acceder a un recurso apartado como un sitio web o una base de datos, puede que se desee crear una simulación manual que te permita usar datos falsos. Esto asegura que tus pruebas serán más rápidas y corrientes.</p>
<h3><a class="anchor" aria-hidden="true" name="mocking-user-modules"></a><a href="#mocking-user-modules" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mocking user modules</h3>
<p>Las simulaciones manuales se definen escribiendo un módulo en el subdirectorio <code>__mocks__</code> inmediatamente adyacente al módulo. Por ejemplo, para simular un módulo llamado <code>user</code> en el directorio <code>models</code>, crea un archivo de nombre <code>user.js</code> y colócalo en el directorio <code>models/__mocks__</code>. Note que la carpeta <code>__mocks__</code> diferencia entre mayúsculas y minúsculas, así que al nombrar el directorio <code>__MOCKS__</code> se romperá en algunos sistemas.</p>
<blockquote>
<p>When we require that module in our tests, then explicitly calling <code>jest.mock('./moduleName')</code> is <strong>required</strong>.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" name="mocking-node-modules"></a><a href="#mocking-node-modules" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mocking Node modules</h3>
<p>If the module you are mocking is a Node module (e.g.: <code>lodash</code>), the mock should be placed in the <code>__mocks__</code> directory adjacent to <code>node_modules</code> (unless you configured <a href="/jest/docs/es-ES/next/configuration.html#roots-array-string"><code>roots</code></a> to point to a folder other than the project root) and will be <strong>automatically</strong> mocked. There's no need to explicitly call <code>jest.mock('module_name')</code>.</p>
<p>Scoped modules can be mocked by creating a file in a directory structure that matches the name of the scoped module. For example, to mock a scoped module called <code>@scope/project-name</code>, create a file at <code>__mocks__/@scope/project-name.js</code>, creating the <code>@scope/</code> directory accordingly.</p>
<blockquote>
<p>Warning: If we want to mock Node's core modules (e.g.: <code>fs</code> or <code>path</code>), then explicitly calling e.g. <code>jest.mock('path')</code> is <strong>required</strong>, because core Node modules are not mocked by default.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" name="ejemplos"></a><a href="#ejemplos" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplos</h3>
<pre><code class="hljs css bash">.
├── config
├── __mocks__
│   └── fs.js
├── models
│   ├── __mocks__
│   │   └── user.js
│   └── user.js
├── node_modules
└── views
</code></pre>
<p>Cuando existe una simulación manual para un módulo dado, el sistema de módulos de Jest usará ese módulo cuando específicamente se llama <code>jest.mock('moduleName')</code>. However, when <code>automock</code> is set to <code>true</code>, the manual mock implementation will be used instead of the automatically created mock, even if <code>jest.mock('moduleName')</code> is not called. Para ignorar este comportamiento necesitarás llamar explícitamente a <code>jest.unmock('moduleName')</code> en pruebas que deberían usar módulo de implementación correspondiente.</p>
<blockquote>
<p>Note: In order to mock properly, Jest needs <code>jest.mock('moduleName')</code> to be in the same scope as the <code>require/import</code> statement.</p>
</blockquote>
<p>Here's a contrived example where we have a module that provides a summary of all the files in a given directory. In this case we use the core (built in) <code>fs</code> module.</p>
<pre><code class="hljs css javascript"><span class="hljs-comment">// FileSummarizer.js</span>
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">summarizeFilesInDirectorySync</span>(<span class="hljs-params">directory</span>) </span>{
  <span class="hljs-keyword">return</span> fs.readdirSync(directory).map(<span class="hljs-function"><span class="hljs-params">fileName</span> =&gt;</span> ({
    directory,
    fileName,
  }));
}

exports.summarizeFilesInDirectorySync = summarizeFilesInDirectorySync;
</code></pre>
<p>Desde que quisimos que nuestras pruebas evadieran golpear el disco (que es algo lento y frágil), podemos crear una simulación manual para el módulo <code>fs</code> extendiendo una simulación automática. El siguiente mock implementa versiones personalizadas del API de <code>fs</code> que puede ser usada en las pruebas:</p>
<pre><code class="hljs css javascript"><span class="hljs-comment">// __mocks__/fs.js</span>
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-keyword">const</span> fs = jest.genMockFromModule(<span class="hljs-string">'fs'</span>);

<span class="hljs-comment">// This is a custom function that our tests can use during setup to specify</span>
<span class="hljs-comment">// what the files on the "mock" filesystem should look like when any of the</span>
<span class="hljs-comment">// `fs` APIs are used.</span>
<span class="hljs-keyword">let</span> mockFiles = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__setMockFiles</span>(<span class="hljs-params">newMockFiles</span>) </span>{
  mockFiles = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> file <span class="hljs-keyword">in</span> newMockFiles) {
    <span class="hljs-keyword">const</span> dir = path.dirname(file);

    <span class="hljs-keyword">if</span> (!mockFiles[dir]) {
      mockFiles[dir] = [];
    }
    mockFiles[dir].push(path.basename(file));
  }
}

<span class="hljs-comment">// A custom version of `readdirSync` that reads from the special mocked out</span>
<span class="hljs-comment">// file list set via __setMockFiles</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readdirSync</span>(<span class="hljs-params">directoryPath</span>) </span>{
  <span class="hljs-keyword">return</span> mockFiles[directoryPath] || [];
}

fs.__setMockFiles = __setMockFiles;
fs.readdirSync = readdirSync;

<span class="hljs-built_in">module</span>.exports = fs;
</code></pre>
<p>Now we write our test. Note that we need to explicitly tell that we want to mock the <code>fs</code> module because it’s a core Node module:</p>
<pre><code class="hljs css javascript"><span class="hljs-comment">// __tests__/FileSummarizer-test.js</span>
<span class="hljs-meta">'use strict'</span>;

jest.mock(<span class="hljs-string">'fs'</span>);

describe(<span class="hljs-string">'listFilesInDirectorySync'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> MOCK_FILE_INFO = {
    <span class="hljs-string">'/path/to/file1.js'</span>: <span class="hljs-string">'console.log("file1 contents");'</span>,
    <span class="hljs-string">'/path/to/file2.txt'</span>: <span class="hljs-string">'file2 contents'</span>,
  };

  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Set up some mocked out file info before each test</span>
    <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>).__setMockFiles(MOCK_FILE_INFO);
  });

  test(<span class="hljs-string">'includes all files in the directory in the summary'</span>, () =&gt; {
    <span class="hljs-keyword">const</span> FileSummarizer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../FileSummarizer'</span>);
    <span class="hljs-keyword">const</span> fileSummary = FileSummarizer.summarizeFilesInDirectorySync(
      <span class="hljs-string">'/path/to'</span>,
    );

    expect(fileSummary.length).toBe(<span class="hljs-number">2</span>);
  });
});
</code></pre>
<p>La simulación de ejemplo mostrada aquí utiliza <a href="/jest/docs/es-ES/next/jest-object.html#jestgenmockfrommodulemodulename"><code>jest.genMockFromModule</code></a> para generar una simulación automática, e ignorar su comportamiento por defecto. Este es el enfoque recomendado, pero es completamente opcional. Si no se desea usar el mock automático, se puede simplemente exportar las funciones desde el archivo del mock. Una desventaja de las simulaciones completamente manuales es que son manuales - significando esto que debes manualmente actualizarlas cada vez que el módulo estén simulando cambie. Por esto, es mejor utilizar o extender la simulación automática cuando trabaja por tus requerimientos.</p>
<p>Para asegurar que un manual de simulación y su implementación real se mantengan en sincronía, puede ser útil solicitar al módulo real que utilice <code>require.requireActual(moduleName)</code> en tu simulación manual y la mejore con funciones de simulación antes de exportarlo.</p>
<p>The code for this example is available at <a href="https://github.com/facebook/jest/tree/master/examples/manual-mocks">examples/manual-mocks</a>.</p>
<h3><a class="anchor" aria-hidden="true" name="usando-con-imports-de-modulos-es"></a><a href="#usando-con-imports-de-modulos-es" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Usando con imports de módulos ES</h3>
<p>Si estás utilizando <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">ES module imports</a> entonces normalmente estarás inclinado a colocar las declaraciones <code>import</code> en la parte superior del archivo de prueba. Pero es a menudo necesario indicarle a Jest que use un mock antes de que los módulos ocupen algún import. Por esta razón, Jest envía las llamadas de <code>jest.mock</code> a la parte superior del módulo (antes de cualquier import). Para aprender más acerca de esto y verlo en acción, véase este <a href="https://github.com/kentcdodds/how-jest-mocking-works">repositorio</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="timer-mocks.html">← Timer Mocks</a><a class="docs-next button" href="es6-class-mocks.html">ES6 Class Mocks →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/jest/" class="nav-home"><img src="/jest/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/jest/docs/es-ES/getting-started.html">Getting Started</a><a href="/jest/docs/es-ES/snapshot-testing.html">Guides</a><a href="/jest/docs/es-ES/api.html">API Reference</a></div><div><h5>Community</h5><a href="/jest/es-ES/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discord.gg/MWRhKCj">Jest Chat</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/jest/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star facebook/jest on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/jest/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 Facebook Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><script>
              var search = docsearch({
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react'
              });
            </script></body></html>