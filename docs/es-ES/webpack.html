<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Using with webpack · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Using with webpack · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/jest/index.html"/><meta property="og:description" content="Jest puede ser usado en proyectos que usan [webpack](https://webpack.github.io/) para manejar recursos, estilos y compilación. Webpack *ofrece* algunos desafíos únicos sobre otras herramientas porque se integra directamente con su aplicación para permitir la gestión de hojas de estilo, recursos como imágenes y fuentes, junto con el extenso ecosistema de lenguajes y herramientas de compilación a JavaScript."/><meta property="og:image" content="/jest/img/opengraph.png"/><link rel="shortcut icon" href="/jest/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="/jest/css/main.css"/><link rel="alternate" type="application/atom+xml" href="https://facebook.github.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://facebook.github.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/jest/"><img class="logo" src="/jest/img/jest.svg"/><h2 class="headerTitle">Jest</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/es-ES/getting-started.html" target="_self">Documentación</a></li><li><a href="/jest/docs/es-ES/api.html" target="_self">API</a></li><li><a href="/jest/es-ES/help.html" target="_self">Ayuda</a></li><li><a href="/jest/blog" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/jest/img/language.svg"/>Español</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/jest/en">English</a></li><li><a href="/jest/ja">日本語</a></li><li><a href="/jest/pt-BR">Português (Brasil)</a></li><li><a href="/jest/ro">Română</a></li><li><a href="/jest/ru">Русский</a></li><li><a href="/jest/uk">Українська</a></li><li><a href="/jest/zh-Hans">简体中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Guides</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/using-matchers.html">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/asynchronous.html">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/setup-teardown.html">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/mock-functions.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/more-resources.html">More Resources</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/api.html">Globals</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/expect.html">Expect</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/mock-function-api.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/jest-object.html">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/configuration.html">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/cli.html">Jest CLI Options</a></li></ul></div><div class="navGroup navGroupActive"><h3>Framework Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/tutorial-react.html">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/tutorial-react-native.html">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/testing-frameworks.html">Testing Web Frameworks</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/snapshot-testing.html">Snapshot Testing</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/tutorial-async.html">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/timer-mocks.html">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/manual-mocks.html">Manual Mocks</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/jest/docs/es-ES/webpack.html">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/migration-guide.html">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/troubleshooting.html">Troubleshooting</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Using with webpack</h1></header><article><div><span><p>Jest puede ser usado en proyectos que usan <a href="https://webpack.github.io/">webpack</a> para manejar recursos, estilos y compilación. Webpack <em>ofrece</em> algunos desafíos únicos sobre otras herramientas porque se integra directamente con su aplicación para permitir la gestión de hojas de estilo, recursos como imágenes y fuentes, junto con el extenso ecosistema de lenguajes y herramientas de compilación a JavaScript.</p>
<h2><a class="anchor" name="un-ejemplo-de-webpack"></a>Un ejemplo de webpack <a class="hash-link" href="#un-ejemplo-de-webpack">#</a></h2>
<p>Vamos a comenzar con un tipo común de archivo de configuración webpack y traducirlo a una configuración de Jest.</p>
<pre><code class="language-js"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">loaders</span>: [
      {<span class="hljs-attr">exclude</span>: [<span class="hljs-string">'node_modules'</span>], <span class="hljs-attr">loader</span>: <span class="hljs-string">'babel'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jsx?$/</span>},
      {<span class="hljs-attr">loader</span>: <span class="hljs-string">'style-loader!css-loader'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>},
      {<span class="hljs-attr">loader</span>: <span class="hljs-string">'url-loader'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.gif$/</span>},
      {<span class="hljs-attr">loader</span>: <span class="hljs-string">'file-loader'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|eot|svg)$/</span>},
    ],
  },
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-attr">config$</span>: <span class="hljs-string">'./configs/app-config.js'</span>,
      <span class="hljs-attr">react</span>: <span class="hljs-string">'./vendor/react-master'</span>,
    },
    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">''</span>, <span class="hljs-string">'js'</span>, <span class="hljs-string">'jsx'</span>],
    <span class="hljs-attr">modules</span>: [
      <span class="hljs-string">'node_modules'</span>, 
      <span class="hljs-string">'bower_components'</span>, 
      <span class="hljs-string">'shared'</span>,
      <span class="hljs-string">'/shared/vendor/modules'</span>,
    ],
  },
};
</code></pre>
<p>If you have JavaScript files that are transformed by Babel, you can <a href="/jest/docs/es-ES/getting-started.html#using-babel-with-jest">enable support for Babel</a> by installing the <code>babel-jest</code> plugin. Non-Babel JavaScript transformations can be handled with Jest's <a href="/jest/docs/es-ES/configuration.html#transform-object-string-string"><code>transform</code></a> config option.</p>
<h3><a class="anchor" name="manejo-de-activos-estaticos"></a>Manejo de activos estáticos <a class="hash-link" href="#manejo-de-activos-estaticos">#</a></h3>
<p>A continuación, vamos a configurar Jest para utilizar archivos como hojas de estilo e imágenes. Generalmente, estos archivos no son particularmente útiles en las pruebas por lo que con seguridad podemos mockearlos. Sin embargo, si utiliza módulos de CSS entonces es mejor mockear un proxy para las búsquedas de className.</p>
<pre><code class="language-json">// package.json
{
  "jest": {
    "moduleNameMapper": {
      "\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$": "&lt;rootDir&gt;/__mocks__/fileMock.js",
      "\\.(css|less)$": "&lt;rootDir&gt;/__mocks__/styleMock.js"
    }
  }
}
</code></pre>
<p>Y mockear los archivos propios:</p>
<pre><code class="language-js"><span class="hljs-comment">// __mocks__/styleMock.js</span>

<span class="hljs-built_in">module</span>.exports = {};
</code></pre>
<pre><code class="language-js"><span class="hljs-comment">// __mocks__/fileMock.js</span>

<span class="hljs-built_in">module</span>.exports = <span class="hljs-string">'test-file-stub'</span>;
</code></pre>
<h3><a class="anchor" name="mockear-modulos-de-css"></a>Mockear Modulos de CSS <a class="hash-link" href="#mockear-modulos-de-css">#</a></h3>
<p>Puede utilizar un <a href="https://github.com/keyanzhang/identity-obj-proxy">ES6 Proxy</a> para mockear <a href="https://github.com/css-modules/css-modules">Modulos de CSS</a>:</p>
<pre><code>npm install --save-dev identity-obj-proxy
</code></pre>
<p>A continuación, se devolverán todas tus búsquedas de className del objeto estilos como (p. ej., <code>styles.foobar === 'foobar'</code>). This is pretty handy for React <a href="/jest/docs/es-ES/snapshot-testing.html">Snapshot Testing</a>.</p>
<pre><code class="language-json">// package.json (for CSS Modules)
{
  "jest": {
    "moduleNameMapper": {
      "\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$": "&lt;rootDir&gt;/__mocks__/fileMock.js",
      "\\.(css|less)$": "identity-obj-proxy"
    }
  }
}
</code></pre>
<blockquote>
<p>Aviso que Proxy está habilitado en Node 6 por defecto. Si aún no estas utilizando Node 6, asegúrate de que invocas Jest usando <code>node --harmony_proxies node_modules/.bin/jest</code>.</p>
</blockquote>
<p>If <code>moduleNameMapper</code> cannot fulfill your requirements, you can use Jest's <a href="/jest/docs/es-ES/configuration.html#transform-object-string-string"><code>transform</code></a> config option to specify how assets are transformed. Por ejemplo, un transformador que devuelve el nombre de un archivo (como <code>require('logo.jpg');</code> devuelve <code>'logo'</code>) puede ser escrito como:</p>
<pre><code class="language-js"><span class="hljs-comment">// fileTransformer.js</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-built_in">module</span>.exports = {
  process(src, filename, config, options) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'module.exports = '</span> + <span class="hljs-built_in">JSON</span>.stringify(path.basename(filename)) + <span class="hljs-string">';'</span>;
  },
};
</code></pre>
<pre><code class="language-json">// package.json (for custom transformers and CSS Modules)
{
  "jest": {
    "moduleNameMapper": {
      "\\.(css|less)$": "identity-obj-proxy"
    },
    "transform": {
      "\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$": "&lt;rootDir&gt;/fileTransformer.js"
    }
  }
}
</code></pre>
<p>Si hemos dicho a Jest que omita archivos que coinciden con una extensión de hoja de estilo o imagen, y por el contrario, necesita nuestros archivos de mock. Puedes ajustar a una expresión regular para que coincida con el tipo de archivos de configuración webpack.</p>
<p><em>Nota: Si utiliza babel-jest con preprocesadores de código adicional, debe definir explícitamente babel-jest como un transformador para el código JavaScript y asignar archivos <code>.js</code> en el módulo de babel-jest.</em></p>
<pre><code class="language-json">"transform": {
  "^.+\\.js$": "babel-jest",
  "^.+\\.css$": "custom-transformer",
  ...
}
</code></pre>
<h3><a class="anchor" name="configurar-jest-para-que-encuentre-nuestros-archivos"></a>Configurar Jest para que encuentre nuestros archivos <a class="hash-link" href="#configurar-jest-para-que-encuentre-nuestros-archivos">#</a></h3>
<p>Ahora que Jest sabe cómo procesar nuestros archivos, tenemos que decirle cómo <em>encontrarlos</em>. Para <code>modulesDirectories</code> de webpack y <code>extensions</code> allí las opciones son análogos directos en opciones de Jest <code>moduleDirectories</code> y <code>moduleFileExtensions</code>.</p>
<pre><code class="language-json">// package.json
{
  "jest": {
    "moduleFileExtensions": ["js", "jsx"],
    "moduleDirectories": ["node_modules", "bower_components", "shared"],

    "moduleNameMapper": {
      "\\.(css|less)$": "&lt;rootDir&gt;/__mocks__/styleMock.js",    
      "\\.(gif|ttf|eot|svg)$": "&lt;rootDir&gt;/__mocks__/fileMock.js"
    }
  }
}
</code></pre>
<blockquote>
<p>Nota: &lt;rootdir&gt; es un símbolo especial que se reemplaza por Jest con la raíz de tu proyecto. La mayoría de las veces se trata de la carpeta donde tu package.json se encuentra a menos que especifiques una opción personalizada <code>rootDir</code> en tu configuración.</p>
</blockquote>
<p>Asimismo la opción de webpack <code>resolve.root</code> como la variable env <code>NODE_PATH</code>, que establece o hacen uso de la opción <code>modulePaths</code>.</p>
<pre><code class="language-json">// package.json
{
  "jest": {
    "modulePaths": [
      "/shared/vendor/modules"
    ],
    "moduleFileExtensions": ["js", "jsx"],
    "moduleDirectories": ["node_modules", "bower_components", "shared"],
    "moduleNameMapper": {
      "\\.(css|less)$": "&lt;rootDir&gt;/__mocks__/styleMock.js",    
      "\\.(gif|ttf|eot|svg)$": "&lt;rootDir&gt;/__mocks__/fileMock.js"
    }
  }
}
</code></pre>
<p>Y por último sólo tenemos webpack <code>alias</code> izquierda para manejar. Para ello podemos hacer uso de la opción de <code>moduleNameMapper</code> otra vez.</p>
<pre><code class="language-json">// package.json
{
  "jest": {
    "modulePaths": [
      "/shared/vendor/modules"
    ],
    "moduleFileExtensions": ["js", "jsx"],
    "moduleDirectories": ["node_modules", "bower_components", "shared"],

    "moduleNameMapper": {
      "^react(.*)$": "&lt;rootDir&gt;/vendor/react-master$1",
      "^config$": "&lt;rootDir&gt;/configs/app-config.js",

      "\\.(css|less)$": "&lt;rootDir&gt;/__mocks__/styleMock.js",    
      "\\.(gif|ttf|eot|svg)$": "&lt;rootDir&gt;/__mocks__/fileMock.js"
    }
  }
}
</code></pre>
<p>¡Eso es todo! webPack es una herramienta compleja y flexible, por lo que tendrás que hacer algunos ajustes para manejar las necesidades específicas de tu aplicación. Afortunadamente para la mayoría de los proyectos, Jest debe ser lo suficientemente flexible como para manejar tu configuración webpack.</p>
<blockquote>
<p>Nota: Para las más complejas configuraciones webpack, también puedes investigar proyectos tales como: <a href="https://github.com/istarkov/babel-plugin-webpack-loaders"> babel-plugin-webpack-loaders</a>.</p>
</blockquote>
<h2><a class="anchor" name="utilizando-webpack-2"></a>Utilizando webpack 2 <a class="hash-link" href="#utilizando-webpack-2">#</a></h2>
<p>webPack 2 ofrece soporte nativo para los módulos de ES. Sin embargo, Jest funciona en Node y por lo tanto requiere que los módulos ES sean transpilados a los módulos de CommonJS. Como tal, si usas webpack 2, probablemente querrás configurar que Babel transpile módulos de ES a módulos de CommonJS sólo en el entorno de <code>pruebas</code>.</p>
<pre><code class="language-json">// .babelrc
{
  "presets": [
    ["es2015", {"modules": false}]
  ],

  "env": {
    "test": {
      "plugins": ["transform-es2015-modules-commonjs"]
    }
  }
}
</code></pre>
<blockquote>
<p>Nota: Jest cachea archivos para acelerar la ejecución de los tests. Si ha actualizado .babelrc y Jest sigue sin funcionar, intente ejecutar Jest con <code>--no-cache</code>.</p>
</blockquote>
<p>Si utilizas las importaciones dinámicas (<code>import('some-file.js').then (módulo = &gt;...)</code>), es necesario activar el plugin de <code>dynamic-import-node</code>.</p>
<pre><code class="language-json">// .babelrc
{
  "presets": [
    ["es2015", {"modules": false}]
  ],

  "plugins": ["syntax-dynamic-import"],

  "env": {
    "test": {
      "plugins": ["dynamic-import-node"]
    }
  }
}
</code></pre>
<p>For an example of how to use Jest with Webpack with React, Redux, and Node, you can view one <a href="https://github.com/jenniferkaplannyc/jest_react_redux_node_webpack_complex_example">here</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="manual-mocks.html">← Manual Mocks</a><a class="docs-next button" href="migration-guide.html">Migrating to Jest →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/jest/" class="nav-home"><img src="/jest/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/jest/docs/es-ES/getting-started.html">Getting Started</a><a href="/jest/docs/es-ES/snapshot-testing.html">Guides</a><a href="/jest/docs/es-ES/api.html">API Reference</a></div><div><h5>Community</h5><a href="/jest/es-ES/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discordapp.com/channels/102860784329052160/103622435865104384">Jest Chat</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/jest/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-count-api="/repos/facebook/jest#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/jest/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2017 Facebook Inc.</section></footer></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><script>
              var search = docsearch({
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react'
              });
            </script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>