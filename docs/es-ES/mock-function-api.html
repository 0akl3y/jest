<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Mock Functions · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Mock Functions · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/jest/index.html"/><meta property="og:description" content="Funciones Mockeadas también son conocidos como &quot;espías&quot;, porque permiten espiar el comportamiento de una función que se llama indirectamente por algunos otros códigos, en lugar de sólo la salida de la prueba. Puedes crear una falsa función con `jest.fn()`. Si no se da la implementación, la función mockeda devolverá `undefined` cuando se invoque."/><meta property="og:image" content="/jest/img/opengraph.png"/><link rel="shortcut icon" href="/jest/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="/jest/css/main.css"/><link rel="alternate" type="application/atom+xml" href="https://facebook.github.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://facebook.github.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/jest/"><img class="logo" src="/jest/img/jest.svg"/><h2 class="headerTitle">Jest</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/es-ES/getting-started.html" target="_self">Documentación</a></li><li><a href="/jest/docs/es-ES/api.html" target="_self">API</a></li><li><a href="/jest/es-ES/help.html" target="_self">Ayuda</a></li><li><a href="/jest/blog" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/jest/img/language.svg"/>Español</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/jest/en">English</a></li><li><a href="/jest/ja">日本語</a></li><li><a href="/jest/pt-BR">Português (Brasil)</a></li><li><a href="/jest/ro">Română</a></li><li><a href="/jest/ru">Русский</a></li><li><a href="/jest/uk">Українська</a></li><li><a href="/jest/zh-Hans">简体中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>API Reference</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/using-matchers.html">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/asynchronous.html">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/setup-teardown.html">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/mock-functions.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/more-resources.html">More Resources</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/api.html">Globals</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/expect.html">Expect</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/jest/docs/es-ES/mock-function-api.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/jest-object.html">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/configuration.html">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/cli.html">Jest CLI Options</a></li></ul></div><div class="navGroup navGroupActive"><h3>Framework Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/tutorial-react.html">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/tutorial-react-native.html">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/testing-frameworks.html">Testing Web Frameworks</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/snapshot-testing.html">Snapshot Testing</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/tutorial-async.html">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/timer-mocks.html">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/manual-mocks.html">Manual Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/webpack.html">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/migration-guide.html">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/es-ES/troubleshooting.html">Troubleshooting</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Mock Functions</h1></header><article><div><span><p>Funciones Mockeadas también son conocidos como &quot;espías&quot;, porque permiten espiar el comportamiento de una función que se llama indirectamente por algunos otros códigos, en lugar de sólo la salida de la prueba. Puedes crear una falsa función con <code>jest.fn()</code>. Si no se da la implementación, la función mockeda devolverá <code>undefined</code> cuando se invoque.</p>
<h2><a class="anchor" name="metodos"></a>Métodos <a class="hash-link" href="#metodos">#</a></h2>
<p>&lt;autogenerated_table_of_contents&gt;</p>
<hr>
<h2><a class="anchor" name="referencia"></a>Referencia <a class="hash-link" href="#referencia">#</a></h2>
<h3><a class="anchor" name="mockfngetmockname"></a><code>mockFn.getMockName()</code> <a class="hash-link" href="#mockfngetmockname">#</a></h3>
<h5><a class="anchor" name="available-in-jest-2130"></a>available in Jest <strong>21.3.0+</strong> <a class="hash-link" href="#available-in-jest-2130">#</a></h5>
<p>Returns the mock name string set by calling <code>mockFn.mockName(value)</code>.</p>
<h3><a class="anchor" name="mockfnmockcalls"></a><code>mockFn.mock.calls</code> <a class="hash-link" href="#mockfnmockcalls">#</a></h3>
<p>Una matriz que representa todas las llamadas que se hicieron en esta función mockeada. Cada llamada está representada por una serie de argumentos que se pasan durante la llamada.</p>
<p>Por ejemplo: una función de mocking <code>f</code> que se ha llamado dos veces, con los argumentos <code>f ('arg1', 'arg2')</code>, y luego con los argumentos <code>f ('arg3', 'arg4')</code> tendría una matriz de <code>mock.calls</code> que se ve así:</p>
<pre><code class="language-js">[
  [<span class="hljs-string">'arg1'</span>, <span class="hljs-string">'arg2'</span>],
  [<span class="hljs-string">'arg3'</span>, <span class="hljs-string">'arg4'</span>],
];
</code></pre>
<h3><a class="anchor" name="mockfnmockinstances"></a><code>mockFn.mock.instances</code> <a class="hash-link" href="#mockfnmockinstances">#</a></h3>
<p>Una matriz que contiene todas las instancias de objeto que han se han creado instancias de esta función mockeada utilizando <code>new</code>.</p>
<p>Por ejemplo: una función mockeada que ha creado una instancia dos veces, tendría la siguiente matriz de <code>mock.instances</code>:</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> mockFn = jest.fn();

<span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> mockFn();
<span class="hljs-keyword">const</span> b = <span class="hljs-keyword">new</span> mockFn();

mockFn.mock.instances[<span class="hljs-number">0</span>] === a; <span class="hljs-comment">// true</span>
mockFn.mock.instances[<span class="hljs-number">1</span>] === b; <span class="hljs-comment">// true</span>
</code></pre>
<h3><a class="anchor" name="mockfnmockclear"></a><code>mockFn.mockClear()</code> <a class="hash-link" href="#mockfnmockclear">#</a></h3>
<p>Restablece toda la información almacenada en las matrices <a href="#mockfn-mock-calls"> <code>mockFn.mock.calls</code></a> y <a href="#mockfn-mock-instances"> <code>mockFn.mock.instances</code></a>.</p>
<p>A menudo esto es útil cuando quieres limpiar datos de uso de mocking entre dos afirmaciones.</p>
<p>Cuidado con ese <code>mockClear</code> reemplazará a <code>mockFn.mock</code>, no <a href="#mockfn-mock-calls"> <code>mockFn.mock.calls</code></a> y <a href="#mockfn-mock-instances"> <code>mockFn.mock.instances</code></a>. Por lo tanto debes evitar asignar <code>mockFn.mock</code> a otras variables, temporales o no, para asegurarse de que no tienes acceso a datos antiguos.</p>
<p>The <a href="configuration.html#clearmocks-boolean"><code>clearMocks</code></a> configuration option is available to clear mocks automatically between tests.</p>
<h3><a class="anchor" name="mockfnmockreset"></a><code>mockFn.mockReset()</code> <a class="hash-link" href="#mockfnmockreset">#</a></h3>
<p>Resets all information stored in the mock, including any initial implementation and mock name given.</p>
<p>Esto es útil cuando deseas restaurar completamente un mock a su estado inicial.</p>
<p>Cuidado con ese <code>mockClear</code> reemplazará a <code>mockFn.mock</code>, no <a href="#mockfn-mock-calls"> <code>mockFn.mock.calls</code></a> y <a href="#mockfn-mock-instances"> <code>mockFn.mock.instances</code></a>. Por lo tanto debes evitar asignar <code>mockFn.mock</code> a otras variables, temporales o no, para asegurarse de que no tienes acceso a datos antiguos.</p>
<h3><a class="anchor" name="mockfnmockrestore"></a><code>mockFn.mockRestore()</code> <a class="hash-link" href="#mockfnmockrestore">#</a></h3>
<p>Remueve el mock y restablece la implementación inicial.</p>
<p>Esto es útil para casos donde se desee simular funciones en ciertas pruebas y restaurar la implementación original para otras.</p>
<p>Se debe tener cuidado que <code>mockFn.mockRestore</code> sólo funcionara para mocks creados con <code>jest.spyOn</code>. De modo que se debe realizar la restauración de manera independiente a Jest cuando se crean mocks con <code>jest.fn()</code>.</p>
<h3><a class="anchor" name="mockfnmockimplementationfn"></a><code>mockFn.mockImplementation(fn)</code> <a class="hash-link" href="#mockfnmockimplementationfn">#</a></h3>
<p>Acepta una función que debe ser utilizada como la implementación de la funcion a mockear. El mockeo de sí mismo aún grabará todas las llamadas que entran y casos que provienen de sí mismo, la única diferencia es que la aplicación también se ejecutará cuando se llama a la funcion mock.</p>
<p><em>Note: <code>jest.fn(implementation)</code> is a shorthand for <code>jest.fn().mockImplementation(implementation)</code>.</em></p>
<p>Por ejemplo:</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> mockFn = jest.fn().mockImplementation(<span class="hljs-function"><span class="hljs-params">scalar</span> =&gt;</span> <span class="hljs-number">42</span> + scalar);
<span class="hljs-comment">// or: jest.fn(scalar =&gt; 42 + scalar);</span>

<span class="hljs-keyword">const</span> a = mockFn(<span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> b = mockFn(<span class="hljs-number">1</span>);

a === <span class="hljs-number">42</span>; <span class="hljs-comment">// true</span>
b === <span class="hljs-number">43</span>; <span class="hljs-comment">// true</span>

mockFn.mock.calls[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] === <span class="hljs-number">0</span>; <span class="hljs-comment">// true</span>
mockFn.mock.calls[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] === <span class="hljs-number">1</span>; <span class="hljs-comment">// true</span>
</code></pre>
<p><code>mockImplementation</code> puede utilizarse también para mockear constructores de clase:</p>
<pre><code>// UnaClase.js
module.exports = class UnaClase {
  m(a, b) {}
}

// OtroModulo.test.js
jest.mock('./UnaClase');  // esto ocurre de manera automática con la opción automocking 
const UnaClase = require('./UnaClase')
const mMock = jest.automocking()
UnaClase.mockImplementation(() =&gt; {
  return {
    m: mMock
  }
})

const una = new UnaClase()
una.m('a', 'b')
console.log('Llamadas a m: ', mMock.mock.calls)
</code></pre>
<h3><a class="anchor" name="mockfnmockimplementationoncefn"></a><code>mockFn.mockImplementationOnce(fn)</code> <a class="hash-link" href="#mockfnmockimplementationoncefn">#</a></h3>
<p>Acepta una función que se utilizará como una implementación de la funcion de mock para una llamada a la función mockeada. Puede ser encadenado para que varias llamadas de función produzcan resultados distintos.</p>
<pre><code>var myMockFn = jest.fn()
  .mockImplementationOnce(cb =&gt; cb(null, true))
  .mockImplementationOnce(cb =&gt; cb(null, false));

myMockFn((err, val) =&gt; console.log(val));
&gt; true

myMockFn((err, val) =&gt; console.log(val));
&gt; false
</code></pre>
<p>Cuando se ejecuta la función mockeada de implementaciones definidas con mockImplementationOnce, se ejecutará la aplicación por defecto con <code>jest.fn(() = &gt; defaultValue)</code> o <code>.mockImplementation(() = &gt; defaultValue)</code> si se llamara:</p>
<pre><code>var myMockFn = jest.fn(() =&gt; 'default')
  .mockImplementationOnce(() =&gt; 'first call')
  .mockImplementationOnce(() =&gt; 'second call');

console.log(myMockFn(), myMockFn(), myMockFn(), myMockFn());
&gt; 'first call', 'second call', 'default', 'default'
</code></pre>
<h3><a class="anchor" name="mockfnmocknamevalue"></a><code>mockFn.mockName(value)</code> <a class="hash-link" href="#mockfnmocknamevalue">#</a></h3>
<h5><a class="anchor" name="available-in-jest-2130"></a>available in Jest <strong>21.3.0+</strong> <a class="hash-link" href="#available-in-jest-2130">#</a></h5>
<p>Accepts a string to use in test result output in place of &quot;jest.fn()&quot; to indicate which mock function is being referenced.</p>
<p>Por ejemplo:</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> mockFn = jest.fn().mockName(<span class="hljs-string">'mockedFunction'</span>);
<span class="hljs-comment">// mockFn();</span>
expect(mockFn).toHaveBeenCalled();
</code></pre>
<p>Will result in this error:</p>
<pre><code>    expect(mockedFunction).toHaveBeenCalled()

    Expected mock function to have been called.
</code></pre>
<h3><a class="anchor" name="mockfnmockreturnthis"></a><code>mockFn.mockReturnThis()</code> <a class="hash-link" href="#mockfnmockreturnthis">#</a></h3>
<p>Sólo una simple función:</p>
<pre><code class="language-js">jest.fn(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
});
</code></pre>
<h3><a class="anchor" name="mockfnmockreturnvaluevalue"></a><code>mockFn.mockReturnValue(value)</code> <a class="hash-link" href="#mockfnmockreturnvaluevalue">#</a></h3>
<p>Accepts a value that will be returned whenever the mock function is called.</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> mock = jest.fn();
mock.mockReturnValue(<span class="hljs-number">42</span>);
mock(); <span class="hljs-comment">// 42</span>
mock.mockReturnValue(<span class="hljs-number">43</span>);
mock(); <span class="hljs-comment">// 43</span>
</code></pre>
<h3><a class="anchor" name="mockfnmockreturnvalueoncevalue"></a><code>mockFn.mockReturnValueOnce(value)</code> <a class="hash-link" href="#mockfnmockreturnvalueoncevalue">#</a></h3>
<p>Accepts a value that will be returned for one call to the mock function. Can be chained so that successive calls to the mock function return different values. When there are no more <code>mockReturnValueOnce</code> values to use, calls will return a value specified by <code>mockReturnValue</code>.</p>
<pre><code>const myMockFn = jest.fn()
  .mockReturnValue('default')
  .mockReturnValueOnce('first call')
  .mockReturnValueOnce('second call');

console.log(myMockFn(), myMockFn(), myMockFn(), myMockFn());
&gt; 'first call', 'second call', 'default', 'default'</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="expect.html">← Expect</a><a class="docs-next button" href="jest-object.html">The Jest Object →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/jest/" class="nav-home"><img src="/jest/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/jest/docs/es-ES/getting-started.html">Getting Started</a><a href="/jest/docs/es-ES/snapshot-testing.html">Guides</a><a href="/jest/docs/es-ES/api.html">API Reference</a></div><div><h5>Community</h5><a href="/jest/es-ES/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discordapp.com/channels/102860784329052160/103622435865104384">Jest Chat</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/jest/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-count-api="/repos/facebook/jest#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/jest/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2017 Facebook Inc.</section></footer></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><script>
              var search = docsearch({
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react'
              });
            </script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>