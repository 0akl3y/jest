<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Setup and Teardown · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Setup and Teardown · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/jest/index.html"/><meta property="og:description" content="Muitas vezes ao escrever testes você tem algum trabalho de configuração que precisa acontecer antes de executar testes, e você tem algum trabalho de acabamento que precisa acontecer após os testes executarem. Jest fornece funções de auxilio para lidar com isso."/><meta property="og:image" content="/jest/img/opengraph.png"/><link rel="shortcut icon" href="/jest/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="/jest/css/main.css"/><link rel="alternate" type="application/atom+xml" href="https://facebook.github.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://facebook.github.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/jest/"><img class="logo" src="/jest/img/jest.svg"/><h2 class="headerTitle">Jest</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/pt-BR/getting-started.html" target="_self">Documentação</a></li><li><a href="/jest/docs/pt-BR/api.html" target="_self">API</a></li><li><a href="/jest/pt-BR/help.html" target="_self">Ajuda</a></li><li><a href="/jest/blog" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/jest/img/language.svg"/>Português (Brasil)</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/jest/en">English</a></li><li><a href="/jest/ja">日本語</a></li><li><a href="/jest/es-ES">Español</a></li><li><a href="/jest/ro">Română</a></li><li><a href="/jest/ru">Русский</a></li><li><a href="/jest/uk">Українська</a></li><li><a href="/jest/zh-Hans">简体中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Introduction</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/using-matchers.html">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/asynchronous.html">Testing Asynchronous Code</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/jest/docs/pt-BR/setup-teardown.html">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/mock-functions.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/more-resources.html">More Resources</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/api.html">Globals</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/expect.html">Expect</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/mock-function-api.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/jest-object.html">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/configuration.html">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/cli.html">Jest CLI Options</a></li></ul></div><div class="navGroup navGroupActive"><h3>Framework Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/tutorial-react.html">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/tutorial-react-native.html">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/testing-frameworks.html">Testing Web Frameworks</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/snapshot-testing.html">Teste de Snapshot</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/tutorial-async.html">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/timer-mocks.html">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/manual-mocks.html">Manual Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/webpack.html">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/migration-guide.html">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/troubleshooting.html">Troubleshooting</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Setup and Teardown</h1></header><article><div><span><p>Muitas vezes ao escrever testes você tem algum trabalho de configuração que precisa acontecer antes de executar testes, e você tem algum trabalho de acabamento que precisa acontecer após os testes executarem. Jest fornece funções de auxilio para lidar com isso.</p>
<h3><a class="anchor" name="repetindo-a-configurac-o-para-varios-testes"></a>Repetindo a Configuração Para Vários Testes <a class="hash-link" href="#repetindo-a-configurac-o-para-varios-testes">#</a></h3>
<p>Se você tem algum trabalho que você precisa fazer repetidamente por muitos testes, você pode usar <code>beforeEach</code> e <code>afterEach</code>.</p>
<p>Por exemplo, digamos que vários testes interagem com um banco de dados de cidades. Você tem um método <code>initializeCityDatabase()</code> que deve ser chamado antes de cada um destes testes e um método <code>clearCityDatabase()</code> que deve ser chamado depois de cada um destes testes. Você pode fazer isso com:</p>
<pre><code class="language-js">beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  initializeCityDatabase();
});

afterEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  clearCityDatabase();
});

test(<span class="hljs-string">'city database has Vienna'</span>, () =&gt; {
  expect(isCity(<span class="hljs-string">'Vienna'</span>)).toBeTruthy();
});

test(<span class="hljs-string">'city database has San Juan'</span>, () =&gt; {
  expect(isCity(<span class="hljs-string">'San Juan'</span>)).toBeTruthy();
});
</code></pre>
<p><code>beforeEach</code> and <code>afterEach</code> can handle asynchronous code in the same ways that <a href="/jest/docs/pt-BR/asynchronous.html">tests can handle asynchronous code</a> - they can either take a <code>done</code> parameter or return a promise. Por exemplo, se <code>initializeCityDatabase()</code> tiver retornado uma promessa que resolve quando o banco de dados foi inicializado, gostaríamos de retornar essa promessa:</p>
<pre><code class="language-js">beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> initializeCityDatabase();
});
</code></pre>
<h3><a class="anchor" name="configurac-o-unica"></a>Configuração Única <a class="hash-link" href="#configurac-o-unica">#</a></h3>
<p>Em alguns casos, você só precisa configurar uma vez, no início de um arquivo. Isto pode ser especialmente incômodo quando a instalação é assíncrona, portanto, não pode fazer isso &quot;inline&quot;. Jest fornece <code>beforeAll</code> e <code>afterAll</code> para lidar com essa situação.</p>
<p>Por exemplo, se ambos <code>initializeCityDatabase</code> e <code>clearCityDatabase</code> retornaram promessas, e o banco de dados de cidades poderia ser reutilizado entre os testes, nós podemos alterar nosso código de teste para:</p>
<pre><code class="language-js">beforeAll(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> initializeCityDatabase();
});

afterAll(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> clearCityDatabase();
});

test(<span class="hljs-string">'city database has Vienna'</span>, () =&gt; {
  expect(isCity(<span class="hljs-string">'Vienna'</span>)).toBeTruthy();
});

test(<span class="hljs-string">'city database has San Juan'</span>, () =&gt; {
  expect(isCity(<span class="hljs-string">'San Juan'</span>)).toBeTruthy();
});
</code></pre>
<h3><a class="anchor" name="escopo"></a>Escopo <a class="hash-link" href="#escopo">#</a></h3>
<p>Por padrão, os blocos <code>before</code> e <code>after</code> se aplicam a todos os testes em um arquivo. Você também pode agrupar testes junto usando um bloco de <code>describe</code>. Quando eles estão dentro de um bloco de <code>describe</code>, os blocos <code>before</code> e <code>after</code> só se aplicam aos testes dentro desse bloco de <code>describe</code>.</p>
<p>Por exemplo, digamos que nós não temos apenas um banco de dados de cidades, mas também um banco de dados de alimentos. Nós podemos fazer uma configuração diferente para diferentes testes:</p>
<pre><code class="language-js"><span class="hljs-comment">// Applies to all tests in this file</span>
beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> initializeCityDatabase();
});

test(<span class="hljs-string">'city database has Vienna'</span>, () =&gt; {
  expect(isCity(<span class="hljs-string">'Vienna'</span>)).toBeTruthy();
});

test(<span class="hljs-string">'city database has San Juan'</span>, () =&gt; {
  expect(isCity(<span class="hljs-string">'San Juan'</span>)).toBeTruthy();
});

describe(<span class="hljs-string">'matching cities to foods'</span>, () =&gt; {
  <span class="hljs-comment">// Applies only to tests in this describe block</span>
  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> initializeFoodDatabase();
  });

  test(<span class="hljs-string">'Vienna &lt;3 sausage'</span>, () =&gt; {
    expect(isValidCityFoodPair(<span class="hljs-string">'Vienna'</span>, <span class="hljs-string">'Wiener Schnitzel'</span>)).toBe(<span class="hljs-literal">true</span>);
  });

  test(<span class="hljs-string">'San Juan &lt;3 plantains'</span>, () =&gt; {
    expect(isValidCityFoodPair(<span class="hljs-string">'San Juan'</span>, <span class="hljs-string">'Mofongo'</span>)).toBe(<span class="hljs-literal">true</span>);
  });
});
</code></pre>
<h3><a class="anchor" name="conselho-geral"></a>Conselho geral <a class="hash-link" href="#conselho-geral">#</a></h3>
<p>Se um teste está falhando, uma das primeiras coisas a verificar deveria ser se o teste está falhando quando é o único teste que é executado. Em Jest, é simples de executar somente um teste - basta apenas temporariamente alterar esse comando <code>test</code> para <code>test.only</code>:</p>
<pre><code class="language-js">test.only(<span class="hljs-string">'this will be the only test that runs'</span>, () =&gt; {
  expect(<span class="hljs-literal">true</span>).toBe(<span class="hljs-literal">false</span>);
});

test(<span class="hljs-string">'this test will not run'</span>, () =&gt; {
  expect(<span class="hljs-string">'A'</span>).toBe(<span class="hljs-string">'A'</span>);
});
</code></pre>
<p>Se você tiver uma teste que muitas vezes falha quando ele é executado como parte de um conjunto maior, mas não falha quando você executá-lo sozinho, é uma boa aposta que algo de um teste diferente está interferindo com ele. Muitas vezes, você pode consertar isso, limpando algum estado compartilhado com <code>beforeEach</code>. Se você não tem certeza se algum estado compartilhado está sendo modificado, você também pode tentar um <code>beforeEach</code> que só registra dados.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="asynchronous.html">← Testing Asynchronous Code</a><a class="docs-next button" href="mock-functions.html">Mock Functions →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/jest/" class="nav-home"><img src="/jest/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/jest/docs/pt-BR/getting-started.html">Getting Started</a><a href="/jest/docs/pt-BR/snapshot-testing.html">Guides</a><a href="/jest/docs/pt-BR/api.html">API Reference</a></div><div><h5>Community</h5><a href="/jest/pt-BR/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discordapp.com/channels/102860784329052160/103622435865104384">Jest Chat</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/jest/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-count-api="/repos/facebook/jest#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/jest/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2017 Facebook Inc.</section></footer></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><script>
              var search = docsearch({
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react'
              });
            </script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>